(()=>{"use strict";class t{constructor(){this.drawing=!1,this.brushWidth=5,this.prevMouseX=null,this.prevMouseY=null,this.snapshot=null,this.selectedTool="brush",this.selectedColor="black"}get isDrawing(){return this.drawing}set isDrawing(t){this.drawing=t}get isSelectedTool(){return this.selectedTool}set isSelectedTool(t){this.selectedTool=t}get mouseX(){return this.prevMouseX}get mouseY(){return this.prevMouseY}set mouseX(t){this.prevMouseX=t}set mouseY(t){this.prevMouseY=t}get snapshotValue(){return this.snapshot}set snapshotValue(t){this.snapshot=t}get brushWidthValue(){return this.brushWidth}set brushWidthValue(t){this.brushWidth=t}get colorValue(){return this.selectedColor}set colorValue(t){this.selectedColor=t}eraserChoosing(){return"eraser"===this.selectedTool}}class e{constructor(){this.canvas=document.querySelector("canvas"),this.ctx=this.canvas.getContext("2d"),this.toolBtns=document.querySelectorAll(".tool"),this.activeOption=document.querySelector(".options .active"),this.fillColor=document.querySelector("#fill-color"),this.sizeSlider=document.querySelector("#size-slider"),this.colorBtns=document.querySelectorAll(".colors .option"),this.activeColorBtn=document.querySelector(".colors .selected"),this.colorPicker=document.querySelector("#colored-picker"),this.clearCanvas=document.querySelector(".clear-canvas"),window.addEventListener("load",(()=>{this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight}))}changeLineWith(t){this.ctx.lineWidth=t}getSnapshot(){return this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)}putSnapshot(t){this.ctx.putImageData(t,0,0)}drawRect(t,e,s){this.fillColor.checked?this.ctx.fillRect(t.offsetX,t.offsetY,e-t.offsetX,s-t.offsetY):this.ctx.strokeRect(t.offsetX,t.offsetY,e-t.offsetX,s-t.offsetY)}drawCircle(t,e,s){this.ctx.beginPath();let i=Math.sqrt(Math.pow(e-t.offsetX,2)+Math.pow(s-t.offsetY,2));this.ctx.arc(e,s,i,0,2*Math.PI),this.fillColor.checked?this.ctx.fill():this.ctx.stroke()}drawTriangle(t,e,s){this.ctx.beginPath(),this.ctx.moveTo(e,s),this.ctx.lineTo(t.offsetX,t.offsetY),this.ctx.lineTo(2*e-t.offsetX,t.offsetY),this.ctx.closePath(),this.fillColor.checked?this.ctx.fill():this.ctx.stroke()}listeningStartDrawing(t){this.canvas.addEventListener("mousedown",(e=>{t(e),this.ctx.beginPath()}))}listeningDrawing(t){this.canvas.addEventListener("mousemove",t)}listeningStopDrawing(t){this.canvas.addEventListener("mouseup",t)}listeningToolBar(t){this.toolBtns.forEach((e=>e.addEventListener("click",(s=>{this.activeOption.classList.remove("active"),e.classList.add("active"),this.activeOption=e,t(s)}))))}listeningChangeSize(t){this.sizeSlider.addEventListener("change",(e=>t(e)))}listeningChangeColor(t){this.colorBtns.forEach((e=>e.addEventListener("click",(s=>{this.activeColorBtn.classList.remove("selected"),e.classList.add("selected"),this.activeColorBtn=e,t(s)}))))}listeningChangeColorPicker(t){this.colorPicker.addEventListener("change",(()=>{this.colorPicker.parentElement.style.background=this.colorPicker.value,this.colorPicker.parentElement.click(),t(this.colorPicker.value)}))}listeningClearCanvas(t){this.clearCanvas.addEventListener("click",(()=>this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)))}}class s{constructor(t,e){this.model=t,this.view=e}init(){this.view.listeningStartDrawing(this.startDraw.bind(this)),this.view.listeningDrawing(this.drawing.bind(this)),this.view.listeningStopDrawing(this.stopDraw.bind(this)),this.view.listeningToolBar(this.choisingToolbar.bind(this)),this.view.listeningChangeSize(this.changeSize.bind(this)),this.view.listeningChangeColor(this.changeColor.bind(this)),this.view.listeningChangeColorPicker(this.changeColorPicker.bind(this)),this.view.listeningClearCanvas()}startDraw(t){this.model.isDrawing=!0,this.model.mouseX=t.offsetX,this.model.mouseY=t.offsetY,this.view.changeLineWith(this.model.brushWidth),this.model.snapshotValue=this.view.getSnapshot(),"eraser"===this.model.isSelectedTool&&(this.model.colorValue="white"),this.view.ctx.fillStyle=this.model.colorValue,this.view.ctx.strokeStyle=this.model.colorValue}drawing(t){this.model.isDrawing&&(this.view.putSnapshot(this.model.snapshotValue),"brush"===this.model.isSelectedTool||"eraser"===this.model.isSelectedTool?(this.view.ctx.lineTo(t.offsetX,t.offsetY),this.view.ctx.stroke()):"rectangle"===this.model.isSelectedTool?this.view.drawRect(t,this.model.mouseX,this.model.mouseY):"circle"===this.model.isSelectedTool?this.view.drawCircle(t,this.model.mouseX,this.model.mouseY):this.view.drawTriangle(t,this.model.mouseX,this.model.mouseY))}stopDraw(){this.model.isDrawing=!1}choisingToolbar(t){this.model.isSelectedTool=t.target.id}changeSize(t){this.model.brushWidthValue=t.target.value}changeColor(t){const e=window.getComputedStyle(t.target).getPropertyValue("background-color");this.model.colorValue=e}changeColorPicker(t){this.model.colorValue=t}}window.addEventListener("DOMContentLoaded",(function(){const i=new t,o=new e;new s(i,o).init()}))})();